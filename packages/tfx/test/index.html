<!doctype html>
<html lang="en">
  <head>
    <script src="./../elements.js"></script>
  </head>
  <body>
    <tfx-definition>
      <tfx-module name="sheet" src="./sheet.js">
        <tfx-function name="format"></tfx-function>
        <tfx-function name="setCurrentSelection"></tfx-function>

        <tfx-variable name="types"></tfx-variable>
        <tfx-variable name="currentSelection"></tfx-variable>
      </tfx-module>
  
      <tfx-function name="getType" evaluate="type => types[type]">        
      </tfx-function>

      <tfx-term name="type">
        <tfx-case pattern="number" evaluate="getType"></tfx-case>
        <tfx-case pattern="date" evaluate="getType"></tfx-case>
      </tfx-term>
      <tfx-term name="cell">
        <tfx-case pattern="${'A':'Z' 0:N}"
          evaluate="([column, row]) => [[row, column], [row, column]]"
        >
        </tfx-case>
      </tfx-term>
      <tfx-term name="range"
          description="A ${range} is an (interval)[https://en.wikipedia.org/wiki/Interval_(mathematics)] of ${cell}s with a ${start} and an ${end}"
          more="https://www.computerhope.com/jargon/r/range.htm"
      >
        <tfx-case pattern="${cell ':' cell}"></tfx-case>
      </tfx-term>
      <tfx-term name="selection"
          pattern="${((cell ',') | (range ',')) ... cell | range}"
      ></tfx-term>

      <tfx-intent name="format">

        <tfx-case pattern="format as ${type}"
          evaluate="([type]) => format(currentSelection, type)"
        >
        </tfx-case>
        <tfx-case pattern="format ${selection} as ${type}"
          evaluate="([selection, type]) => format(selection, type)"
        >
          <tfx-effect evaluate="() => setCurrentSelection(selection)"></tfx-effect>
        </tfx-case>

      </tfx-intent>
    </tfx-definition>
    <!-- <tfx-definition version="0.0.1-alpha.1"></tfx-definition> -->
  </body>
</html>
